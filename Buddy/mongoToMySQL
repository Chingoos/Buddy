import pymongo
from pymongo import MongoClient
import MySQLdb

conn = MySQLdb.connect(host= "buddystaging.cfvxqjolxisb.us-west-2.rds.amazonaws.com",user="Buddy",passwd="dogdogjim123",db="staging")
x = conn.cursor()




client = pymongo.MongoClient()

db = client.staging

x.execute("""DROP TABLE IF EXISTS venue""")
x.execute("""CREATE TABLE venue (venue_id INT PRIMARY KEY AUTO_INCREMENT NOT NULL, 
name VARCHAR(50), address VARCHAR(50), city VARCHAR(20), state VARCHAR(20))""")
  
for v in db.venues.find():
  try:
    x.execute("""INSERT INTO venue(name, address, city, state) VALUES (%s, %s, %s, %s)""", (v['name'], v['location']['address'], v['location']['city'], v['location']['state']))
  except:
    print v['name']
  
conn.commit()
conn.close()
